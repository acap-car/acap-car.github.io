(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8533,1057],{50594:function(e,t,n){"use strict";var r=n(64836);t.Z=void 0;var a=r(n(64938)),i=n(85893),o=(0,a.default)((0,i.jsx)("path",{d:"M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"}),"Close");t.Z=o},11057:function(e,t,n){"use strict";n.d(t,{Z:function(){return Z}});var r=n(63366),a=n(87462),i=n(67294),o=n(86010),s=n(47925),c=n(27192),l=n(41796),u=n(11496),d=n(33616),p=n(47739),f=n(98216),v=n(28979);function h(e){return(0,v.Z)("MuiButton",e)}var x=(0,n(76087).Z)("MuiButton",["root","text","textInherit","textPrimary","textSecondary","outlined","outlinedInherit","outlinedPrimary","outlinedSecondary","contained","containedInherit","containedPrimary","containedSecondary","disableElevation","focusVisible","disabled","colorInherit","textSizeSmall","textSizeMedium","textSizeLarge","outlinedSizeSmall","outlinedSizeMedium","outlinedSizeLarge","containedSizeSmall","containedSizeMedium","containedSizeLarge","sizeMedium","sizeSmall","sizeLarge","fullWidth","startIcon","endIcon","iconSizeSmall","iconSizeMedium","iconSizeLarge"]),m=n(98363),b=n(85893);const g=["children","color","component","className","disabled","disableElevation","disableFocusRipple","endIcon","focusVisibleClassName","fullWidth","size","startIcon","type","variant"],w=e=>(0,a.Z)({},"small"===e.size&&{"& > *:nth-of-type(1)":{fontSize:18}},"medium"===e.size&&{"& > *:nth-of-type(1)":{fontSize:20}},"large"===e.size&&{"& > *:nth-of-type(1)":{fontSize:22}}),y=(0,u.ZP)(p.Z,{shouldForwardProp:e=>(0,u.FO)(e)||"classes"===e,name:"MuiButton",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.root,t[n.variant],t[`${n.variant}${(0,f.Z)(n.color)}`],t[`size${(0,f.Z)(n.size)}`],t[`${n.variant}Size${(0,f.Z)(n.size)}`],"inherit"===n.color&&t.colorInherit,n.disableElevation&&t.disableElevation,n.fullWidth&&t.fullWidth]}})((({theme:e,ownerState:t})=>(0,a.Z)({},e.typography.button,{minWidth:64,padding:"6px 16px",borderRadius:e.shape.borderRadius,transition:e.transitions.create(["background-color","box-shadow","border-color","color"],{duration:e.transitions.duration.short}),"&:hover":(0,a.Z)({textDecoration:"none",backgroundColor:(0,l.Fq)(e.palette.text.primary,e.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}},"text"===t.variant&&"inherit"!==t.color&&{backgroundColor:(0,l.Fq)(e.palette[t.color].main,e.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}},"outlined"===t.variant&&"inherit"!==t.color&&{border:`1px solid ${e.palette[t.color].main}`,backgroundColor:(0,l.Fq)(e.palette[t.color].main,e.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}},"contained"===t.variant&&{backgroundColor:e.palette.grey.A100,boxShadow:e.shadows[4],"@media (hover: none)":{boxShadow:e.shadows[2],backgroundColor:e.palette.grey[300]}},"contained"===t.variant&&"inherit"!==t.color&&{backgroundColor:e.palette[t.color].dark,"@media (hover: none)":{backgroundColor:e.palette[t.color].main}}),"&:active":(0,a.Z)({},"contained"===t.variant&&{boxShadow:e.shadows[8]}),[`&.${x.focusVisible}`]:(0,a.Z)({},"contained"===t.variant&&{boxShadow:e.shadows[6]}),[`&.${x.disabled}`]:(0,a.Z)({color:e.palette.action.disabled},"outlined"===t.variant&&{border:`1px solid ${e.palette.action.disabledBackground}`},"outlined"===t.variant&&"secondary"===t.color&&{border:`1px solid ${e.palette.action.disabled}`},"contained"===t.variant&&{color:e.palette.action.disabled,boxShadow:e.shadows[0],backgroundColor:e.palette.action.disabledBackground})},"text"===t.variant&&{padding:"6px 8px"},"text"===t.variant&&"inherit"!==t.color&&{color:e.palette[t.color].main},"outlined"===t.variant&&{padding:"5px 15px",border:"1px solid "+("light"===e.palette.mode?"rgba(0, 0, 0, 0.23)":"rgba(255, 255, 255, 0.23)")},"outlined"===t.variant&&"inherit"!==t.color&&{color:e.palette[t.color].main,border:`1px solid ${(0,l.Fq)(e.palette[t.color].main,.5)}`},"contained"===t.variant&&{color:e.palette.getContrastText(e.palette.grey[300]),backgroundColor:e.palette.grey[300],boxShadow:e.shadows[2]},"contained"===t.variant&&"inherit"!==t.color&&{color:e.palette[t.color].contrastText,backgroundColor:e.palette[t.color].main},"inherit"===t.color&&{color:"inherit",borderColor:"currentColor"},"small"===t.size&&"text"===t.variant&&{padding:"4px 5px",fontSize:e.typography.pxToRem(13)},"large"===t.size&&"text"===t.variant&&{padding:"8px 11px",fontSize:e.typography.pxToRem(15)},"small"===t.size&&"outlined"===t.variant&&{padding:"3px 9px",fontSize:e.typography.pxToRem(13)},"large"===t.size&&"outlined"===t.variant&&{padding:"7px 21px",fontSize:e.typography.pxToRem(15)},"small"===t.size&&"contained"===t.variant&&{padding:"4px 10px",fontSize:e.typography.pxToRem(13)},"large"===t.size&&"contained"===t.variant&&{padding:"8px 22px",fontSize:e.typography.pxToRem(15)},t.fullWidth&&{width:"100%"})),(({ownerState:e})=>e.disableElevation&&{boxShadow:"none","&:hover":{boxShadow:"none"},[`&.${x.focusVisible}`]:{boxShadow:"none"},"&:active":{boxShadow:"none"},[`&.${x.disabled}`]:{boxShadow:"none"}})),k=(0,u.ZP)("span",{name:"MuiButton",slot:"StartIcon",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.startIcon,t[`iconSize${(0,f.Z)(n.size)}`]]}})((({ownerState:e})=>(0,a.Z)({display:"inherit",marginRight:8,marginLeft:-4},"small"===e.size&&{marginLeft:-2},w(e)))),S=(0,u.ZP)("span",{name:"MuiButton",slot:"EndIcon",overridesResolver:(e,t)=>{const{ownerState:n}=e;return[t.endIcon,t[`iconSize${(0,f.Z)(n.size)}`]]}})((({ownerState:e})=>(0,a.Z)({display:"inherit",marginRight:-4,marginLeft:8},"small"===e.size&&{marginRight:-2},w(e))));var Z=i.forwardRef((function(e,t){const n=i.useContext(m.Z),l=(0,s.Z)(n,e),u=(0,d.Z)({props:l,name:"MuiButton"}),{children:p,color:v="primary",component:x="button",className:w,disabled:Z=!1,disableElevation:j=!1,disableFocusRipple:z=!1,endIcon:C,focusVisibleClassName:R,fullWidth:N=!1,size:O="medium",startIcon:I,type:E,variant:P="text"}=u,U=(0,r.Z)(u,g),W=(0,a.Z)({},u,{color:v,component:x,disabled:Z,disableElevation:j,disableFocusRipple:z,fullWidth:N,size:O,type:E,variant:P}),L=(e=>{const{color:t,disableElevation:n,fullWidth:r,size:i,variant:o,classes:s}=e,l={root:["root",o,`${o}${(0,f.Z)(t)}`,`size${(0,f.Z)(i)}`,`${o}Size${(0,f.Z)(i)}`,"inherit"===t&&"colorInherit",n&&"disableElevation",r&&"fullWidth"],label:["label"],startIcon:["startIcon",`iconSize${(0,f.Z)(i)}`],endIcon:["endIcon",`iconSize${(0,f.Z)(i)}`]},u=(0,c.Z)(l,h,s);return(0,a.Z)({},s,u)})(W),$=I&&(0,b.jsx)(k,{className:L.startIcon,ownerState:W,children:I}),B=C&&(0,b.jsx)(S,{className:L.endIcon,ownerState:W,children:C});return(0,b.jsxs)(y,(0,a.Z)({ownerState:W,className:(0,o.Z)(w,n.className),component:x,disabled:Z,focusRipple:!z,focusVisibleClassName:(0,o.Z)(L.focusVisible,R),ref:t,type:E},U,{classes:L,children:[$,p,B]}))}))},98363:function(e,t,n){"use strict";const r=n(67294).createContext({});t.Z=r},45577:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/admin/news",function(){return n(73854)}])},73854:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return I}});var r=n(85893),a=n(95243),i=n(66383),o=n(47426),s=n(34051),c=n.n(s),l=n(67294),u=n(2734),d=n(98396),p=n(87357),f=n(15861),v=n(61903),h=n(11057),x=n(50657),m=n(37645),b=n(93946),g=n(6514),w=n(31425),y=n(98993),k=n(50594),S=n(89328),Z=n(36100),j=n(86650);function z(e,t,n,r,a,i,o){try{var s=e[i](o),c=s.value}catch(l){return void n(l)}s.done?t(c):Promise.resolve(c).then(r,a)}function C(e){return function(){var t=this,n=arguments;return new Promise((function(r,a){var i=e.apply(t,n);function o(e){z(i,r,a,o,s,"next",e)}function s(e){z(i,r,a,o,s,"throw",e)}o(void 0)}))}}function R(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function N(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"===typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){R(e,t,n[t])}))}return e}function O(){var e=(0,l.useState)([]),t=e[0],n=e[1],a=(0,l.useState)(""),i=a[0],o=a[1],s=(0,l.useState)(""),z=s[0],O=s[1],I=(0,l.useState)([]),E=I[0],P=I[1],U=(0,l.useState)([]),W=U[0],L=U[1],$=(0,l.useState)(!1),B=$[0],F=$[1],T=(0,l.useState)(null),D=T[0],_=T[1],M=(0,l.useState)({}),A=M[0],J=M[1],V=(0,l.useState)(!1),q=V[0],Q=V[1],X=(0,l.useState)(""),H=X[0],G=X[1],K=(0,l.useState)(""),Y=K[0],ee=K[1],te=(0,l.useState)([]),ne=te[0],re=te[1],ae=(0,l.useState)(""),ie=ae[0],oe=ae[1],se=(0,l.useState)([]),ce=se[0],le=se[1],ue=(0,u.Z)(),de=(0,d.Z)(ue.breakpoints.down("sm")),pe=function(e){if(!e)return 0;if("function"===typeof(null===e||void 0===e?void 0:e.toDate))return e.toDate().getTime();if(null===e||void 0===e?void 0:e.seconds)return 1e3*Number(e.seconds);if("number"===typeof e)return e;var t=Number(e);if(!Number.isNaN(t)&&t>0)return t;var n=Date.parse(String(e));return Number.isNaN(n)?0:n},fe=function(e){var t=pe(e);if(!t)return"";try{return new Date(t).toLocaleString()}catch(n){return""}};(0,l.useEffect)((function(){ve()}),[]),(0,l.useEffect)((function(){if(E&&0!==E.length){var e=E.map((function(e){return URL.createObjectURL(e)}));return L(e),function(){e.forEach((function(e){return URL.revokeObjectURL(e)}))}}L([])}),[E]),(0,l.useEffect)((function(){if(ne&&0!==ne.length){var e=ne.map((function(e){return URL.createObjectURL(e)}));return le(e),function(){e.forEach((function(e){return URL.revokeObjectURL(e)}))}}le([])}),[ne]);var ve=function(){var e=C(c().mark((function e(){var t,r;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,y.lh)();case 2:return t=e.sent,(r=(t||[]).map((function(e){return N({},e,{imageUrl:he(e.imageUrl)})}))).sort((function(e,t){return pe(t.created)-pe(e.created)})),r.length>0&&console.debug("loaded news (imageUrl shapes)",r.slice(0,5).map((function(e){return{id:e.id,imageUrl:e.imageUrl}}))),n(r),e.next=9,ye(r);case 9:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),he=function(e){if(!e)return[];if(Array.isArray(e))return e.map((function(e){return"string"===typeof e?e:(null===e||void 0===e?void 0:e.url)||(null===e||void 0===e?void 0:e.downloadURL)||""})).filter(Boolean);if("object"===typeof e){var t=e.url||e.downloadURL||e.downloadUrl||e.path||e.fullPath;return t?[String(t)]:[]}if("string"===typeof e){try{var n=JSON.parse(e);if(Array.isArray(n))return n.map((function(e){return"string"===typeof e?e:(null===e||void 0===e?void 0:e.url)||""})).filter(Boolean)}catch(r){}return e.split(",").map((function(e){return e.trim()})).filter(Boolean)}return[]},xe=function(e,t){return(null===e||void 0===e?void 0:e.id)||(null===e||void 0===e?void 0:e.newsId)||String(t)},me=function(e){if(!e)return[];var t,n,r,a=null!==(r=null!==(n=null!==(t=e.imageUrl)&&void 0!==t?t:e.images)&&void 0!==n?n:e.imagesList)&&void 0!==r?r:"";return he(a)},be=/(https?:\/\/[^\s]+)/g,ge=function(e){if(!e)return null;for(var t,n=[],a=0;null!==(t=be.exec(e));){var i=t.index,o=t[0];i>a&&n.push({type:"text",text:e.slice(a,i)}),n.push({type:"url",text:o}),a=i+o.length}return a<e.length&&n.push({type:"text",text:e.slice(a)}),n.map((function(e,t){return"url"===e.type?(0,r.jsx)("a",{href:e.text,target:"_blank",rel:"noopener noreferrer",style:{color:"#1976d2",textDecoration:"underline"},children:e.text},t):(0,r.jsx)("span",{children:e.text},t)}))},we=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:300;if(!e)return"";var n=e.replace(/\s+/g," ").trim();return n.length>t?n.slice(0,t).trim()+"...":n},ye=function(){var e=C(c().mark((function e(){var t,n,r=arguments;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=r.length>0&&void 0!==r[0]?r[0]:[],n={},e.next=4,Promise.all((t||[]).map(function(){var e=C(c().mark((function e(t,r){var a,i,o,s;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=xe(t,r),e.prev=1,i=(0,Z.JU)(S.db,"news",a),e.next=5,(0,Z.QT)(i);case 5:if(!(o=e.sent).exists()){e.next=17;break}if("number"===typeof(s=o.data()).views){e.next=14;break}return e.next=11,(0,Z.pl)(i,{views:0},{merge:!0});case 11:n[a]=0,e.next=15;break;case 14:n[a]=s.views;case 15:e.next=20;break;case 17:return e.next=19,(0,Z.pl)(i,{views:0},{merge:!0});case 19:n[a]=0;case 20:e.next=25;break;case 22:e.prev=22,e.t0=e.catch(1),n[a]=0;case 25:case"end":return e.stop()}}),e,null,[[1,22]])})));return function(t,n){return e.apply(this,arguments)}}()));case 4:J(n);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),ke=function(){var e=C(c().mark((function e(){var t,n,r,a,i,o,s,l,u,d,p,f,v=arguments;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((t=v.length>0&&void 0!==v[0]?v[0]:[])&&0!==t.length){e.next=3;break}return e.abrupt("return",[]);case 3:n=[],r=!0,a=!1,i=void 0,e.prev=5,o=t[Symbol.iterator]();case 7:if(r=(s=o.next()).done){e.next=20;break}if(l=s.value){e.next=11;break}return e.abrupt("continue",17);case 11:return u="".concat(Date.now(),"_").concat(l.name||"img"),d="news/".concat(u),p=(0,j.iH)(S.tO,d),f={contentType:l.type||"image/jpeg"},e.next=17,new Promise((function(e,t){var r=(0,j.B0)(p,l,f);r.on("state_changed",(function(){}),(function(e){return t(e)}),C(c().mark((function a(){var i;return c().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,(0,j.Jt)(r.snapshot.ref);case 3:i=a.sent,n.push(i),e(),a.next=11;break;case 8:a.prev=8,a.t0=a.catch(0),t(a.t0);case 11:case"end":return a.stop()}}),a,null,[[0,8]])}))))}));case 17:r=!0,e.next=7;break;case 20:e.next=26;break;case 22:e.prev=22,e.t0=e.catch(5),a=!0,i=e.t0;case 26:e.prev=26,e.prev=27,r||null==o.return||o.return();case 29:if(e.prev=29,!a){e.next=32;break}throw i;case 32:return e.finish(29);case 33:return e.finish(26);case 34:return e.abrupt("return",n);case 35:case"end":return e.stop()}}),e,null,[[5,22,26,34],[27,,29,33]])})));return function(){return e.apply(this,arguments)}}(),Se=function(){var e=C(c().mark((function e(t,n){var r,a,i,o,s,l,u;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=xe(t,n),a=(0,Z.JU)(S.db,"news",r),e.prev=2,e.next=5,(0,Z.i3)(S.db,function(){var e=C(c().mark((function e(t){var n;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.get(a);case 2:(n=e.sent).exists()?"number"!==typeof n.data().views?t.update(a,{views:1}):t.update(a,{views:(0,Z.nP)(1)}):t.set(a,{views:1},{merge:!0});case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 5:return e.next=7,(0,Z.QT)(a);case 7:return i=e.sent,o=i.exists()&&"number"===typeof i.data().views?i.data().views:0,J((function(e){return N({},e,R({},r,o))})),e.abrupt("return",o);case 13:return e.prev=13,e.t0=e.catch(2),console.error("incrementNewsView failed",e.t0),e.prev=16,e.next=19,(0,Z.QT)(a);case 19:return s=e.sent,l=s.exists()&&"number"===typeof s.data().views?s.data().views+1:1,e.next=23,(0,Z.pl)(a,{views:l},{merge:!0});case 23:return J((function(e){return N({},e,R({},r,l))})),e.abrupt("return",l);case 27:return e.prev=27,e.t1=e.catch(16),console.error("fallback failed",e.t1),e.abrupt("return",null!==(u=A[r])&&void 0!==u?u:0);case 32:case"end":return e.stop()}}),e,null,[[2,13],[16,27]])})));return function(t,n){return e.apply(this,arguments)}}(),Ze=function(){var e=C(c().mark((function e(t,n){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Se(t,n);case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),console.error("increment on view failed",e.t0);case 8:_(t),Q(!1),G(t.title||""),ee(t.content||""),oe(t.imageUrl||""),re([]),F(!0);case 15:case"end":return e.stop()}}),e,null,[[0,5]])})));return function(t,n){return e.apply(this,arguments)}}(),je=function(){F(!1),_(null),Q(!1),re([])},ze=function(){var e=C(c().mark((function e(){var t,n,r,a;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(D){e.next=2;break}return e.abrupt("return");case 2:if(e.prev=2,t=void 0,!(ne&&ne.length>0)){e.next=8;break}return e.next=7,ke(ne);case 7:t=e.sent;case 8:return n=(0,Z.JU)(S.db,"news",D.id),r={title:H,content:Y},void 0!==t&&(r.imageUrl=t),!ie||t&&0!==t.length||(r.imageUrl="string"===typeof ie&&ie.length>0?function(){try{return JSON.parse(ie)}catch(e){return ie}}():r.imageUrl),Object.keys(r).forEach((function(e){"undefined"===typeof r[e]&&delete r[e]})),e.next=15,(0,Z.r7)(n,r);case 15:return e.next=17,ve();case 17:return e.next=19,(0,y.lh)();case 19:if(e.t0=e.sent.find((function(e){return e.id===D.id})),e.t0){e.next=22;break}e.t0=D;case 22:a=e.t0,_(a),Q(!1),e.next=30;break;case 27:e.prev=27,e.t1=e.catch(2),console.error("saveDialogEdit failed",e.t1);case 30:case"end":return e.stop()}}),e,null,[[2,27]])})));return function(){return e.apply(this,arguments)}}(),Ce=function(){var e=C(c().mark((function e(){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(D&&D.id){e.next=2;break}return e.abrupt("return");case 2:return e.prev=2,e.next=5,(0,y.kN)(D.id,null===D||void 0===D?void 0:D.imageUrl);case 5:return F(!1),_(null),e.next=9,ve();case 9:e.next=14;break;case 11:e.prev=11,e.t0=e.catch(2),console.error("deleteFromDialog failed",e.t0);case 14:case"end":return e.stop()}}),e,null,[[2,11]])})));return function(){return e.apply(this,arguments)}}(),Re=function(){var e=C(c().mark((function e(){var t,n;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i&&z){e.next=2;break}return e.abrupt("return");case 2:if(e.prev=2,!(E&&E.length>0)){e.next=9;break}return e.next=6,ke(E);case 6:e.t0=e.sent,e.next=10;break;case 9:e.t0=[];case 10:return t=e.t0,n={title:i,content:z,created:(0,Z.Bt)(),imageUrl:t},e.next=14,(0,Z.ET)((0,Z.hJ)(S.db,"news"),n);case 14:e.next=20;break;case 16:return e.prev=16,e.t1=e.catch(2),console.error("create news failed",e.t1),e.abrupt("return");case 20:return o(""),O(""),P([]),e.next=25,ve();case 25:case"end":return e.stop()}}),e,null,[[2,16]])})));return function(){return e.apply(this,arguments)}}();return(0,r.jsxs)(p.Z,{sx:{maxWidth:900,mx:"auto",mt:4,px:{xs:2,sm:3}},children:[(0,r.jsx)(f.Z,{variant:"h4",gutterBottom:!0,children:"News Management"}),(0,r.jsxs)(p.Z,{sx:{mb:3},children:[(0,r.jsx)(v.Z,{label:"Title",value:i,onChange:function(e){return o(e.target.value)},fullWidth:!0,sx:{mb:2}}),(0,r.jsx)(v.Z,{label:"Content",value:z,onChange:function(e){return O(e.target.value)},fullWidth:!0,multiline:!0,minRows:4,maxRows:16,sx:{mb:2},InputProps:{style:{whiteSpace:"pre-line",overflow:"auto"}}}),(0,r.jsx)("input",{type:"file",accept:"image/*",multiple:!0,onChange:function(e){return P(Array.from(e.target.files))},style:{marginBottom:12}}),W.length>0&&(0,r.jsx)(p.Z,{sx:{display:"flex",gap:1,mb:2,flexWrap:"wrap"},children:W.map((function(e,t){return(0,r.jsx)(p.Z,{component:"img",src:e,alt:"preview-".concat(t),sx:{width:120,height:80,objectFit:"cover",borderRadius:1}},t)}))}),(0,r.jsx)(h.Z,{variant:"contained",onClick:Re,children:"Create News"})]}),t.map((function(e,t){var n,a=xe(e,t),i=me(e),o=i.length>0?i[0]:null;return(0,r.jsxs)(p.Z,{sx:{display:"flex",flexDirection:{xs:"column",sm:"row"},gap:2,alignItems:"flex-start",mb:3,p:2,borderRadius:2,bgcolor:"background.paper",boxShadow:1,cursor:"pointer"},onClick:function(){return Ze(e,t)},children:[o&&(0,r.jsx)(p.Z,{component:"img",src:String(o),alt:"thumb",onError:function(e){var t;console.error("news thumb failed to load:",null===e||void 0===e||null===(t=e.target)||void 0===t?void 0:t.src),e.target.style.display="none"},sx:{width:{xs:"100%",sm:360},height:{xs:180,sm:220},objectFit:"cover",borderRadius:1,border:"1px solid #eee",flexShrink:0}}),(0,r.jsxs)(p.Z,{sx:{flex:1,minWidth:0},children:[(0,r.jsx)(f.Z,{variant:"h6",sx:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:{xs:"normal",sm:"nowrap"}},children:e.title}),(0,r.jsxs)(p.Z,{sx:{display:"flex",gap:2,alignItems:"center",mb:1,flexWrap:"wrap"},children:[(0,r.jsx)(f.Z,{variant:"caption",color:"text.secondary",children:fe(e.created)}),(0,r.jsxs)(f.Z,{variant:"caption",color:"text.secondary",sx:{ml:"auto"},children:["Views: ",null!==(n=A[a])&&void 0!==n?n:0]})]}),(0,r.jsx)(f.Z,{variant:"body2",color:"text.secondary",sx:{display:"-webkit-box",WebkitLineClamp:{xs:5,sm:6},WebkitBoxOrient:"vertical",overflow:"hidden",textOverflow:"ellipsis",mb:1},children:ge(we(e.content))}),(0,r.jsx)(p.Z,{sx:{display:"flex",gap:1,alignItems:"center"},children:(0,r.jsx)(h.Z,{size:"small",onClick:function(n){n.stopPropagation(),Ze(e,t)},children:"See more"})})]})]},a)})),(0,r.jsxs)(x.Z,{open:B,onClose:je,fullWidth:!0,maxWidth:"md",fullScreen:de,children:[(0,r.jsxs)(m.Z,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,r.jsx)(p.Z,{children:q?(0,r.jsx)(v.Z,{value:H,onChange:function(e){return G(e.target.value)},fullWidth:!0}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(f.Z,{variant:"h6",children:null===D||void 0===D?void 0:D.title}),(0,r.jsx)(f.Z,{variant:"caption",color:"text.secondary",children:fe(null===D||void 0===D?void 0:D.created)})]})}),(0,r.jsxs)(p.Z,{children:[!q&&(0,r.jsx)(h.Z,{size:"small",onClick:function(){var e;D&&(Q(!0),G(D.title||""),ee(D.content||""),oe(null!==(e=null===D||void 0===D?void 0:D.imageUrl)&&void 0!==e?e:""),re([]))},sx:{mr:1},children:"Edit"}),q&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(h.Z,{size:"small",onClick:ze,variant:"contained",sx:{mr:1},children:"Save"}),(0,r.jsx)(h.Z,{size:"small",onClick:function(){return Q(!1)},sx:{mr:1},children:"Cancel"})]}),(0,r.jsx)(b.Z,{onClick:je,children:(0,r.jsx)(k.Z,{})})]})]}),(0,r.jsxs)(g.Z,{dividers:!0,children:[D&&me(D).length>0&&(0,r.jsx)(p.Z,{sx:{mb:2},children:me(D).map((function(e,t){var n=e?String(e):"";return n?(0,r.jsx)(p.Z,{component:"img",src:n,alt:"news-".concat(t),onError:function(e){var t;console.error("dialog image failed to load:",null===e||void 0===e||null===(t=e.target)||void 0===t?void 0:t.src),e.target.style.display="none"},sx:{width:"100%",borderRadius:8,mb:1}},t):null}))}),q?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(v.Z,{value:Y,onChange:function(e){return ee(e.target.value)},fullWidth:!0,multiline:!0,minRows:6,sx:{mb:2}}),(0,r.jsxs)(p.Z,{sx:{mb:2},children:[(0,r.jsx)("input",{type:"file",accept:"image/*",multiple:!0,onChange:function(e){return re(Array.from(e.target.files))}}),ce.length>0&&(0,r.jsx)(p.Z,{sx:{mt:1,display:"flex",gap:1,flexWrap:"wrap"},children:ce.map((function(e,t){return(0,r.jsx)("img",{src:e,alt:"preview-".concat(t),style:{width:120,height:80,objectFit:"cover",borderRadius:8}},t)}))}),0===ne.length&&(me(D).length>0||ie&&String(ie).length>0)&&(0,r.jsx)(p.Z,{sx:{mt:1},children:me(D).map((function(e,t){var n=e?String(e):"";return n?(0,r.jsx)("img",{src:n,alt:"stored-".concat(t),style:{maxWidth:120,height:80,objectFit:"cover",borderRadius:8,marginRight:8}},t):null}))})]})]}):(0,r.jsx)(f.Z,{sx:{whiteSpace:"pre-line"},children:ge(null===D||void 0===D?void 0:D.content)})]}),(0,r.jsxs)(w.Z,{children:[q&&(0,r.jsx)(h.Z,{onClick:Ce,color:"error",size:"small",children:"Delete News"}),(0,r.jsx)(h.Z,{onClick:je,size:"small",children:"Close"})]})]})]})}var I=(0,a.Z)((function(e){var t=e.loading,n=e.user,a=e.onBtnLogoutClick;return(0,r.jsx)(i.Z,{loading:t,user:n,onBtnLogoutClick:a,accLevel:o.DW.ADMIN,children:(0,r.jsx)(O,{})})}))},98993:function(e,t,n){"use strict";n.d(t,{lh:function(){return v},kN:function(){return x}});var r=n(34051),a=n.n(r),i=n(89328),o=n(36100),s=n(86650);function c(e,t,n,r,a,i,o){try{var s=e[i](o),c=s.value}catch(l){return void n(l)}s.done?t(c):Promise.resolve(c).then(r,a)}function l(e){return function(){var t=this,n=arguments;return new Promise((function(r,a){var i=e.apply(t,n);function o(e){c(i,r,a,o,s,"next",e)}function s(e){c(i,r,a,o,s,"throw",e)}o(void 0)}))}}function u(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function d(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"===typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){u(e,t,n[t])}))}return e}var p="news",f=(0,s.cF)();function v(){return h.apply(this,arguments)}function h(){return(h=l(a().mark((function e(){var t,n;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=(0,o.IO)((0,o.hJ)(i.db,p),(0,o.Xo)("created","desc")),e.next=3,(0,o.PL)(t);case 3:return n=e.sent,e.abrupt("return",n.docs.map((function(e){return d({id:e.id},e.data())})));case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function x(e,t){return m.apply(this,arguments)}function m(){return(m=l(a().mark((function e(t,n){var r,c,l,u,d,v,h,x;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!n){e.next=38;break}r=Array.isArray(n)?n:"string"===typeof n?[n]:(null===n||void 0===n?void 0:n.url)?[n.url]:[],c=!0,l=!1,u=void 0,e.prev=4,d=r[Symbol.iterator]();case 6:if(c=(v=d.next()).done){e.next=24;break}if(h=v.value){e.next=10;break}return e.abrupt("continue",21);case 10:if("string"!==typeof h||!h.startsWith("http://")&&!h.startsWith("https://")){e.next=12;break}return e.abrupt("continue",21);case 12:return e.prev=12,x=(0,s.iH)(f,h),e.next=16,(0,s.oq)(x);case 16:e.next=21;break;case 18:e.prev=18,e.t0=e.catch(12),console.warn("deleteNews: failed to delete storage object",h,(null===e.t0||void 0===e.t0?void 0:e.t0.message)||e.t0);case 21:c=!0,e.next=6;break;case 24:e.next=30;break;case 26:e.prev=26,e.t1=e.catch(4),l=!0,u=e.t1;case 30:e.prev=30,e.prev=31,c||null==d.return||d.return();case 33:if(e.prev=33,!l){e.next=36;break}throw u;case 36:return e.finish(33);case 37:return e.finish(30);case 38:e.next=43;break;case 40:e.prev=40,e.t2=e.catch(0),console.warn("deleteNews: unexpected error while deleting images",(null===e.t2||void 0===e.t2?void 0:e.t2.message)||e.t2);case 43:if(!t){e.next=48;break}return e.next=46,(0,o.oe)((0,o.JU)(i.db,p,t));case 46:e.next=49;break;case 48:console.warn("deleteNews called without id, skipping document delete");case 49:case"end":return e.stop()}}),e,null,[[0,40],[4,26,30,38],[12,18],[31,,33,37]])})))).apply(this,arguments)}}},function(e){e.O(0,[5124,7739,8858,1903,6279,3203,6038,1050,9774,2888,179],(function(){return t=45577,e(e.s=t);var t}));var t=e.O();_N_E=t}]);