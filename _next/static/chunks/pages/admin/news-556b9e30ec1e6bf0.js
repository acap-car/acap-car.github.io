(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8533],{45577:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/admin/news",function(){return n(73854)}])},73854:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return E}});var r=n(85893),a=n(95243),i=n(66383),o=n(47426),c=n(34051),s=n.n(c),u=n(67294),l=n(2734),f=n(98396),d=n(87357),p=n(15861),v=n(61903),x=n(11057),h=n(88082),m=n(10633),g=n(50657),b=n(37645),w=n(93946),y=n(6514),j=n(31425),k=n(98993),S=n(50594),Z=n(89328),O=n(36100),C=n(86650);function N(e,t,n,r,a,i,o){try{var c=e[i](o),s=c.value}catch(u){return void n(u)}c.done?t(s):Promise.resolve(s).then(r,a)}function U(e){return function(){var t=this,n=arguments;return new Promise((function(r,a){var i=e.apply(t,n);function o(e){N(i,r,a,o,c,"next",e)}function c(e){N(i,r,a,o,c,"throw",e)}o(void 0)}))}}function P(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function _(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"===typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){P(e,t,n[t])}))}return e}function R(){var e=(0,u.useState)([]),t=e[0],n=e[1],a=(0,u.useState)(1),i=a[0],o=a[1],c=(0,u.useState)(""),N=c[0],R=c[1],E=(0,u.useState)(""),W=E[0],L=E[1],D=(0,u.useState)([]),J=D[0],I=D[1],B=(0,u.useState)([]),A=B[0],F=B[1],T=(0,u.useState)(!1),z=T[0],M=T[1],Q=(0,u.useState)(null),X=Q[0],H=Q[1],V=(0,u.useState)({}),q=V[0],G=V[1],K=(0,u.useState)(new Set),Y=K[0],$=K[1],ee=(0,u.useState)(!1),te=ee[0],ne=ee[1],re=(0,u.useState)(""),ae=re[0],ie=re[1],oe=(0,u.useState)(""),ce=oe[0],se=oe[1],ue=(0,u.useState)([]),le=ue[0],fe=ue[1],de=(0,u.useState)(""),pe=de[0],ve=de[1],xe=(0,u.useState)([]),he=xe[0],me=xe[1],ge=(0,l.Z)(),be=(0,f.Z)(ge.breakpoints.down("sm")),we=function(e){if(!e)return 0;if("function"===typeof(null===e||void 0===e?void 0:e.toDate))return e.toDate().getTime();if(null===e||void 0===e?void 0:e.seconds)return 1e3*Number(e.seconds);if("number"===typeof e)return e;var t=Number(e);if(!Number.isNaN(t)&&t>0)return t;var n=Date.parse(String(e));return Number.isNaN(n)?0:n},ye=function(e){var t=we(e);if(!t)return"";try{return new Date(t).toLocaleString()}catch(n){return""}};(0,u.useEffect)((function(){try{var e=window.localStorage.getItem("news_read_ids")||"{}",t=JSON.parse(e||"{}");$(new Set(Object.keys(t)))}catch(n){$(new Set)}je()}),[]),(0,u.useEffect)((function(){try{var e=Math.max(1,Math.ceil((t||[]).length/5));i>e&&o(e)}catch(n){}}),[t,i]),(0,u.useEffect)((function(){if(J&&0!==J.length){var e=J.map((function(e){return URL.createObjectURL(e)}));return F(e),function(){e.forEach((function(e){return URL.revokeObjectURL(e)}))}}F([])}),[J]),(0,u.useEffect)((function(){if(le&&0!==le.length){var e=le.map((function(e){return URL.createObjectURL(e)}));return me(e),function(){e.forEach((function(e){return URL.revokeObjectURL(e)}))}}me([])}),[le]);var je=function(){var e=U(s().mark((function e(){var t,r;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,k.lh)();case 2:return t=e.sent,(r=(t||[]).map((function(e){return _({},e,{imageUrl:ke(e.imageUrl)})}))).sort((function(e,t){return we(t.created)-we(e.created)})),r.length>0&&console.debug("loaded news (imageUrl shapes)",r.slice(0,5).map((function(e){return{id:e.id,imageUrl:e.imageUrl}}))),n(r),e.next=9,Ue(r);case 9:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),ke=function(e){if(!e)return[];if(Array.isArray(e))return e.map((function(e){return"string"===typeof e?e:(null===e||void 0===e?void 0:e.url)||(null===e||void 0===e?void 0:e.downloadURL)||""})).filter(Boolean);if("object"===typeof e){var t=e.url||e.downloadURL||e.downloadUrl||e.path||e.fullPath;return t?[String(t)]:[]}if("string"===typeof e){try{var n=JSON.parse(e);if(Array.isArray(n))return n.map((function(e){return"string"===typeof e?e:(null===e||void 0===e?void 0:e.url)||""})).filter(Boolean)}catch(r){}return e.split(",").map((function(e){return e.trim()})).filter(Boolean)}return[]},Se=function(e,t){return(null===e||void 0===e?void 0:e.id)||(null===e||void 0===e?void 0:e.newsId)||String(t)},Ze=function(e){if(!e)return[];var t,n,r,a=null!==(r=null!==(n=null!==(t=e.imageUrl)&&void 0!==t?t:e.images)&&void 0!==n?n:e.imagesList)&&void 0!==r?r:"";return ke(a)},Oe=/(https?:\/\/[^\s]+)/g,Ce=function(e){if(!e)return null;for(var t,n=[],a=0;null!==(t=Oe.exec(e));){var i=t.index,o=t[0];i>a&&n.push({type:"text",text:e.slice(a,i)}),n.push({type:"url",text:o}),a=i+o.length}return a<e.length&&n.push({type:"text",text:e.slice(a)}),n.map((function(e,t){return"url"===e.type?(0,r.jsx)("a",{href:e.text,target:"_blank",rel:"noopener noreferrer",style:{color:"#1976d2",textDecoration:"underline"},children:e.text},t):(0,r.jsx)("span",{children:e.text},t)}))},Ne=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:300;if(!e)return"";var n=e.replace(/\s+/g," ").trim();return n.length>t?n.slice(0,t).trim()+"...":n},Ue=function(){var e=U(s().mark((function e(){var t,n,r=arguments;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=r.length>0&&void 0!==r[0]?r[0]:[],n={},e.next=4,Promise.all((t||[]).map(function(){var e=U(s().mark((function e(t,r){var a,i,o,c;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=Se(t,r),e.prev=1,i=(0,O.JU)(Z.db,"news",a),e.next=5,(0,O.QT)(i);case 5:if(!(o=e.sent).exists()){e.next=17;break}if("number"===typeof(c=o.data()).views){e.next=14;break}return e.next=11,(0,O.pl)(i,{views:0},{merge:!0});case 11:n[a]=0,e.next=15;break;case 14:n[a]=c.views;case 15:e.next=20;break;case 17:return e.next=19,(0,O.pl)(i,{views:0},{merge:!0});case 19:n[a]=0;case 20:e.next=25;break;case 22:e.prev=22,e.t0=e.catch(1),n[a]=0;case 25:case"end":return e.stop()}}),e,null,[[1,22]])})));return function(t,n){return e.apply(this,arguments)}}()));case 4:G(n);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Pe=function(){var e=U(s().mark((function e(){var t,n,r,a,i,o,c,u,l,f,d,p,v=arguments;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((t=v.length>0&&void 0!==v[0]?v[0]:[])&&0!==t.length){e.next=3;break}return e.abrupt("return",[]);case 3:n=[],r=!0,a=!1,i=void 0,e.prev=5,o=t[Symbol.iterator]();case 7:if(r=(c=o.next()).done){e.next=20;break}if(u=c.value){e.next=11;break}return e.abrupt("continue",17);case 11:return l="".concat(Date.now(),"_").concat(u.name||"img"),f="news/".concat(l),d=(0,C.iH)(Z.tO,f),p={contentType:u.type||"image/jpeg"},e.next=17,new Promise((function(e,t){var r=(0,C.B0)(d,u,p);r.on("state_changed",(function(){}),(function(e){return t(e)}),U(s().mark((function a(){var i;return s().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,(0,C.Jt)(r.snapshot.ref);case 3:i=a.sent,n.push(i),e(),a.next=11;break;case 8:a.prev=8,a.t0=a.catch(0),t(a.t0);case 11:case"end":return a.stop()}}),a,null,[[0,8]])}))))}));case 17:r=!0,e.next=7;break;case 20:e.next=26;break;case 22:e.prev=22,e.t0=e.catch(5),a=!0,i=e.t0;case 26:e.prev=26,e.prev=27,r||null==o.return||o.return();case 29:if(e.prev=29,!a){e.next=32;break}throw i;case 32:return e.finish(29);case 33:return e.finish(26);case 34:return e.abrupt("return",n);case 35:case"end":return e.stop()}}),e,null,[[5,22,26,34],[27,,29,33]])})));return function(){return e.apply(this,arguments)}}(),_e=function(){var e=U(s().mark((function e(t,n){var r,a,i,o,c,u,l;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=Se(t,n),a=(0,O.JU)(Z.db,"news",r),e.prev=2,e.next=5,(0,O.i3)(Z.db,function(){var e=U(s().mark((function e(t){var n;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.get(a);case 2:(n=e.sent).exists()?"number"!==typeof n.data().views?t.update(a,{views:1}):t.update(a,{views:(0,O.nP)(1)}):t.set(a,{views:1},{merge:!0});case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 5:return e.next=7,(0,O.QT)(a);case 7:return i=e.sent,o=i.exists()&&"number"===typeof i.data().views?i.data().views:0,G((function(e){return _({},e,P({},r,o))})),e.abrupt("return",o);case 13:return e.prev=13,e.t0=e.catch(2),console.error("incrementNewsView failed",e.t0),e.prev=16,e.next=19,(0,O.QT)(a);case 19:return c=e.sent,u=c.exists()&&"number"===typeof c.data().views?c.data().views+1:1,e.next=23,(0,O.pl)(a,{views:u},{merge:!0});case 23:return G((function(e){return _({},e,P({},r,u))})),e.abrupt("return",u);case 27:return e.prev=27,e.t1=e.catch(16),console.error("fallback failed",e.t1),e.abrupt("return",null!==(l=q[r])&&void 0!==l?l:0);case 32:case"end":return e.stop()}}),e,null,[[2,13],[16,27]])})));return function(t,n){return e.apply(this,arguments)}}(),Re=function(){var e=U(s().mark((function e(t,n){var r,a,i;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,_e(t,n);case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),console.error("increment on view failed",e.t0);case 8:H(t),ne(!1),ie(t.title||""),se(t.content||""),ve(t.imageUrl||""),fe([]),M(!0);try{r=Se(t,n),a=window.localStorage.getItem("news_read_ids")||"{}",(i=JSON.parse(a||"{}"))[r]=Date.now(),window.localStorage.setItem("news_read_ids",JSON.stringify(i)),$(new Set(Object.keys(i)))}catch(o){}case 16:case"end":return e.stop()}}),e,null,[[0,5]])})));return function(t,n){return e.apply(this,arguments)}}(),Ee=function(){M(!1),H(null),ne(!1),fe([])},We=function(){var e=U(s().mark((function e(){var t,n,r,a;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(X){e.next=2;break}return e.abrupt("return");case 2:if(e.prev=2,t=void 0,!(le&&le.length>0)){e.next=8;break}return e.next=7,Pe(le);case 7:t=e.sent;case 8:return n=(0,O.JU)(Z.db,"news",X.id),r={title:ae,content:ce},void 0!==t&&(r.imageUrl=t),!pe||t&&0!==t.length||(r.imageUrl="string"===typeof pe&&pe.length>0?function(){try{return JSON.parse(pe)}catch(e){return pe}}():r.imageUrl),Object.keys(r).forEach((function(e){"undefined"===typeof r[e]&&delete r[e]})),e.next=15,(0,O.r7)(n,r);case 15:return e.next=17,je();case 17:return e.next=19,(0,k.lh)();case 19:if(e.t0=e.sent.find((function(e){return e.id===X.id})),e.t0){e.next=22;break}e.t0=X;case 22:a=e.t0,H(a),ne(!1),e.next=30;break;case 27:e.prev=27,e.t1=e.catch(2),console.error("saveDialogEdit failed",e.t1);case 30:case"end":return e.stop()}}),e,null,[[2,27]])})));return function(){return e.apply(this,arguments)}}(),Le=function(){var e=U(s().mark((function e(){return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(X&&X.id){e.next=2;break}return e.abrupt("return");case 2:return e.prev=2,e.next=5,(0,k.kN)(X.id,null===X||void 0===X?void 0:X.imageUrl);case 5:return M(!1),H(null),e.next=9,je();case 9:e.next=14;break;case 11:e.prev=11,e.t0=e.catch(2),console.error("deleteFromDialog failed",e.t0);case 14:case"end":return e.stop()}}),e,null,[[2,11]])})));return function(){return e.apply(this,arguments)}}(),De=function(){var e=U(s().mark((function e(){var t,n;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(N&&W){e.next=2;break}return e.abrupt("return");case 2:if(e.prev=2,!(J&&J.length>0)){e.next=9;break}return e.next=6,Pe(J);case 6:e.t0=e.sent,e.next=10;break;case 9:e.t0=[];case 10:return t=e.t0,n={title:N,content:W,created:(0,O.Bt)(),imageUrl:t},e.next=14,(0,O.ET)((0,O.hJ)(Z.db,"news"),n);case 14:e.next=20;break;case 16:return e.prev=16,e.t1=e.catch(2),console.error("create news failed",e.t1),e.abrupt("return");case 20:return R(""),L(""),I([]),e.next=25,je();case 25:case"end":return e.stop()}}),e,null,[[2,16]])})));return function(){return e.apply(this,arguments)}}();return(0,r.jsxs)(d.Z,{sx:{maxWidth:900,mx:"auto",mt:4,px:{xs:2,sm:3}},children:[(0,r.jsx)(p.Z,{variant:"h4",gutterBottom:!0,children:"News Management"}),(0,r.jsxs)(d.Z,{sx:{mb:3},children:[(0,r.jsx)(v.Z,{label:"Title",value:N,onChange:function(e){return R(e.target.value)},fullWidth:!0,sx:{mb:2}}),(0,r.jsx)(v.Z,{label:"Content",value:W,onChange:function(e){return L(e.target.value)},fullWidth:!0,multiline:!0,minRows:4,maxRows:16,sx:{mb:2},InputProps:{style:{whiteSpace:"pre-line",overflow:"auto"}}}),(0,r.jsx)("input",{type:"file",accept:"image/*",multiple:!0,onChange:function(e){return I(Array.from(e.target.files))},style:{marginBottom:12}}),A.length>0&&(0,r.jsx)(d.Z,{sx:{display:"flex",gap:1,mb:2,flexWrap:"wrap"},children:A.map((function(e,t){return(0,r.jsx)(d.Z,{component:"img",src:e,alt:"preview-".concat(t),sx:{width:120,height:80,objectFit:"cover",borderRadius:1}},t)}))}),(0,r.jsx)(x.Z,{variant:"contained",onClick:De,children:"Create News"})]}),function(){var e=5*(i-1);return(t||[]).slice(e,e+5).map((function(t,n){var a,i=Ze(t),o=e+n,c=Se(t,o),s=i.length>0?i[0]:null,u=Y.has(String(c)),l=!u;return(0,r.jsxs)(d.Z,{sx:{display:"flex",flexDirection:{xs:"column",sm:"row"},gap:2,alignItems:"flex-start",mb:3,p:2,borderRadius:2,bgcolor:l?"rgba(255,249,196,0.08)":"background.paper",boxShadow:1,cursor:"pointer"},onClick:function(){return Re(t,o)},children:[s&&(0,r.jsx)(d.Z,{component:"img",src:String(s),alt:"thumb",onError:function(e){var t;console.error("news thumb failed to load:",null===e||void 0===e||null===(t=e.target)||void 0===t?void 0:t.src),e.target.style.display="none"},sx:{width:{xs:"100%",sm:360},height:{xs:180,sm:220},objectFit:"cover",borderRadius:1,border:"1px solid #eee",flexShrink:0}}),(0,r.jsxs)(d.Z,{sx:{flex:1,minWidth:0},children:[(0,r.jsx)(h.Z,{color:"error",variant:"dot",invisible:!l,sx:{mr:1},children:(0,r.jsx)(p.Z,{variant:"h6",sx:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:{xs:"normal",sm:"nowrap"},fontWeight:u?700:400},children:t.title})}),(0,r.jsxs)(d.Z,{sx:{display:"flex",gap:2,alignItems:"center",mb:1,flexWrap:"wrap"},children:[(0,r.jsx)(p.Z,{variant:"caption",color:"text.secondary",children:ye(t.created)}),(0,r.jsxs)(p.Z,{variant:"caption",color:"text.secondary",sx:{ml:"auto"},children:["Views: ",null!==(a=q[c])&&void 0!==a?a:0]})]}),(0,r.jsx)(p.Z,{variant:"body2",color:"text.secondary",sx:{display:"-webkit-box",WebkitLineClamp:{xs:5,sm:6},WebkitBoxOrient:"vertical",overflow:"hidden",textOverflow:"ellipsis",mb:1},children:Ce(Ne(t.content))}),(0,r.jsx)(d.Z,{sx:{display:"flex",gap:1,alignItems:"center"},children:(0,r.jsx)(x.Z,{size:"small",onClick:function(e){e.stopPropagation(),Re(t,o)},children:"See more"})})]})]},c)}))}(),t.length>5&&(0,r.jsx)(d.Z,{sx:{display:"flex",justifyContent:"center",mt:2},children:(0,r.jsx)(m.Z,{count:Math.ceil(t.length/5),page:i,onChange:function(e,t){return o(t)},color:"primary"})}),(0,r.jsxs)(g.Z,{open:z,onClose:Ee,fullWidth:!0,maxWidth:"md",fullScreen:be,children:[(0,r.jsxs)(b.Z,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,r.jsx)(d.Z,{children:te?(0,r.jsx)(v.Z,{value:ae,onChange:function(e){return ie(e.target.value)},fullWidth:!0}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(p.Z,{variant:"h6",children:null===X||void 0===X?void 0:X.title}),(0,r.jsx)(p.Z,{variant:"caption",color:"text.secondary",children:ye(null===X||void 0===X?void 0:X.created)})]})}),(0,r.jsxs)(d.Z,{children:[!te&&(0,r.jsx)(x.Z,{size:"small",onClick:function(){var e;X&&(ne(!0),ie(X.title||""),se(X.content||""),ve(null!==(e=null===X||void 0===X?void 0:X.imageUrl)&&void 0!==e?e:""),fe([]))},sx:{mr:1},children:"Edit"}),te&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(x.Z,{size:"small",onClick:We,variant:"contained",sx:{mr:1},children:"Save"}),(0,r.jsx)(x.Z,{size:"small",onClick:function(){return ne(!1)},sx:{mr:1},children:"Cancel"})]}),(0,r.jsx)(w.Z,{onClick:Ee,children:(0,r.jsx)(S.Z,{})})]})]}),(0,r.jsxs)(y.Z,{dividers:!0,children:[X&&Ze(X).length>0&&(0,r.jsx)(d.Z,{sx:{mb:2},children:Ze(X).map((function(e,t){var n=e?String(e):"";return n?(0,r.jsx)(d.Z,{component:"img",src:n,alt:"news-".concat(t),onError:function(e){var t;console.error("dialog image failed to load:",null===e||void 0===e||null===(t=e.target)||void 0===t?void 0:t.src),e.target.style.display="none"},sx:{width:"100%",borderRadius:8,mb:1}},t):null}))}),te?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(v.Z,{value:ce,onChange:function(e){return se(e.target.value)},fullWidth:!0,multiline:!0,minRows:6,sx:{mb:2}}),(0,r.jsxs)(d.Z,{sx:{mb:2},children:[(0,r.jsx)("input",{type:"file",accept:"image/*",multiple:!0,onChange:function(e){return fe(Array.from(e.target.files))}}),he.length>0&&(0,r.jsx)(d.Z,{sx:{mt:1,display:"flex",gap:1,flexWrap:"wrap"},children:he.map((function(e,t){return(0,r.jsx)("img",{src:e,alt:"preview-".concat(t),style:{width:120,height:80,objectFit:"cover",borderRadius:8}},t)}))}),0===le.length&&(Ze(X).length>0||pe&&String(pe).length>0)&&(0,r.jsx)(d.Z,{sx:{mt:1},children:Ze(X).map((function(e,t){var n=e?String(e):"";return n?(0,r.jsx)("img",{src:n,alt:"stored-".concat(t),style:{maxWidth:120,height:80,objectFit:"cover",borderRadius:8,marginRight:8}},t):null}))})]})]}):(0,r.jsx)(p.Z,{sx:{whiteSpace:"pre-line"},children:Ce(null===X||void 0===X?void 0:X.content)})]}),(0,r.jsxs)(j.Z,{children:[te&&(0,r.jsx)(x.Z,{onClick:Le,color:"error",size:"small",children:"Delete News"}),(0,r.jsx)(x.Z,{onClick:Ee,size:"small",children:"Close"})]})]})]})}var E=(0,a.Z)((function(e){var t=e.loading,n=e.user,a=e.onBtnLogoutClick;return(0,r.jsx)(i.Z,{loading:t,user:n,onBtnLogoutClick:a,accLevel:o.DW.ADMIN,children:(0,r.jsx)(R,{})})}))},98993:function(e,t,n){"use strict";n.d(t,{lh:function(){return v},kN:function(){return h}});var r=n(34051),a=n.n(r),i=n(89328),o=n(36100),c=n(86650);function s(e,t,n,r,a,i,o){try{var c=e[i](o),s=c.value}catch(u){return void n(u)}c.done?t(s):Promise.resolve(s).then(r,a)}function u(e){return function(){var t=this,n=arguments;return new Promise((function(r,a){var i=e.apply(t,n);function o(e){s(i,r,a,o,c,"next",e)}function c(e){s(i,r,a,o,c,"throw",e)}o(void 0)}))}}function l(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function f(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"===typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){l(e,t,n[t])}))}return e}var d="news",p=(0,c.cF)();function v(){return x.apply(this,arguments)}function x(){return(x=u(a().mark((function e(){var t,n;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=(0,o.IO)((0,o.hJ)(i.db,d),(0,o.Xo)("created","desc")),e.next=3,(0,o.PL)(t);case 3:return n=e.sent,e.abrupt("return",n.docs.map((function(e){return f({id:e.id},e.data())})));case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function h(e,t){return m.apply(this,arguments)}function m(){return(m=u(a().mark((function e(t,n){var r,s,u,l,f,v,x,h;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!n){e.next=38;break}r=Array.isArray(n)?n:"string"===typeof n?[n]:(null===n||void 0===n?void 0:n.url)?[n.url]:[],s=!0,u=!1,l=void 0,e.prev=4,f=r[Symbol.iterator]();case 6:if(s=(v=f.next()).done){e.next=24;break}if(x=v.value){e.next=10;break}return e.abrupt("continue",21);case 10:if("string"!==typeof x||!x.startsWith("http://")&&!x.startsWith("https://")){e.next=12;break}return e.abrupt("continue",21);case 12:return e.prev=12,h=(0,c.iH)(p,x),e.next=16,(0,c.oq)(h);case 16:e.next=21;break;case 18:e.prev=18,e.t0=e.catch(12),console.warn("deleteNews: failed to delete storage object",x,(null===e.t0||void 0===e.t0?void 0:e.t0.message)||e.t0);case 21:s=!0,e.next=6;break;case 24:e.next=30;break;case 26:e.prev=26,e.t1=e.catch(4),u=!0,l=e.t1;case 30:e.prev=30,e.prev=31,s||null==f.return||f.return();case 33:if(e.prev=33,!u){e.next=36;break}throw l;case 36:return e.finish(33);case 37:return e.finish(30);case 38:e.next=43;break;case 40:e.prev=40,e.t2=e.catch(0),console.warn("deleteNews: unexpected error while deleting images",(null===e.t2||void 0===e.t2?void 0:e.t2.message)||e.t2);case 43:if(!t){e.next=48;break}return e.next=46,(0,o.oe)((0,o.JU)(i.db,d,t));case 46:e.next=49;break;case 48:console.warn("deleteNews called without id, skipping document delete");case 49:case"end":return e.stop()}}),e,null,[[0,40],[4,26,30,38],[12,18],[31,,33,37]])})))).apply(this,arguments)}}},function(e){e.O(0,[5124,7739,8858,1903,6279,3203,6038,5085,1050,9774,2888,179],(function(){return t=45577,e(e.s=t);var t}));var t=e.O();_N_E=t}]);