(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8533],{45577:function(n,t,e){(window.__NEXT_P=window.__NEXT_P||[]).push(["/admin/news",function(){return e(73854)}])},73854:function(n,t,e){"use strict";e.r(t),e.d(t,{default:function(){return C}});var r=e(85893),a=e(95243),i=e(66383),u=e(47426),c=e(34051),o=e.n(c),s=e(67294),l=e(87357),f=e(15861),h=e(61903),x=e(11057),p=e(66242),d=e(44267),m=e(93946),v=e(98993),w=e(41733),g=e(77957),b=e(66818),j=e(44510);function y(n,t,e,r,a,i,u){try{var c=n[i](u),o=c.value}catch(s){return void e(s)}c.done?t(o):Promise.resolve(o).then(r,a)}function k(n){return function(){var t=this,e=arguments;return new Promise((function(r,a){var i=n.apply(t,e);function u(n){y(i,r,a,u,c,"next",n)}function c(n){y(i,r,a,u,c,"throw",n)}u(void 0)}))}}function Z(){var n=(0,s.useState)([]),t=n[0],e=n[1],a=(0,s.useState)(""),i=a[0],u=a[1],c=(0,s.useState)(""),y=c[0],Z=c[1],C=(0,s.useState)(null),S=C[0],_=C[1],O=(0,s.useState)(null),P=O[0],N=O[1],D=(0,s.useState)(""),B=D[0],E=D[1],U=(0,s.useState)(""),W=U[0],J=U[1],L=(0,s.useState)(null),T=L[0],H=L[1],I=(0,s.useState)(""),F=I[0],X=I[1];(0,s.useEffect)((function(){(0,v.lh)().then(e)}),[]);var q=function(){var n=k(o().mark((function n(){return o().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(i&&y){n.next=2;break}return n.abrupt("return");case 2:return n.next=4,(0,v.yQ)({title:i,content:y},S);case 4:u(""),Z(""),_(null),(0,v.lh)().then(e);case 8:case"end":return n.stop()}}),n)})));return function(){return n.apply(this,arguments)}}(),K=function(){var n=k(o().mark((function n(t,r){return o().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(!window.confirm("Delete this news?")){n.next=4;break}return n.next=3,(0,v.kN)(t,r);case 3:(0,v.lh)().then(e);case 4:case"end":return n.stop()}}),n)})));return function(t,e){return n.apply(this,arguments)}}(),M=function(){var n=k(o().mark((function n(){return o().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,(0,v.jB)(P,{title:B,content:W},T,F);case 2:N(null),E(""),J(""),H(null),X(""),(0,v.lh)().then(e);case 8:case"end":return n.stop()}}),n)})));return function(){return n.apply(this,arguments)}}(),Q=function(){N(null),E(""),J(""),H(null),X("")};return(0,r.jsxs)(l.Z,{sx:{maxWidth:800,mx:"auto",mt:4},children:[(0,r.jsx)(f.Z,{variant:"h4",gutterBottom:!0,children:"News Management"}),(0,r.jsxs)(l.Z,{sx:{mb:3},children:[(0,r.jsx)(h.Z,{label:"Title",value:i,onChange:function(n){return u(n.target.value)},fullWidth:!0,sx:{mb:2}}),(0,r.jsx)(h.Z,{label:"Content",value:y,onChange:function(n){return Z(n.target.value)},fullWidth:!0,multiline:!0,rows:4,sx:{mb:2}}),(0,r.jsx)("input",{type:"file",accept:"image/*",onChange:function(n){return _(n.target.files[0])},style:{marginBottom:16}}),(0,r.jsx)(x.Z,{variant:"contained",onClick:q,children:"Create News"})]}),t.map((function(n,t){return(0,r.jsx)(p.Z,{sx:{mb:2,position:"relative"},children:(0,r.jsx)(d.Z,{children:P===n.id?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(h.Z,{label:"Title",value:B,onChange:function(n){return E(n.target.value)},fullWidth:!0,sx:{mb:2}}),(0,r.jsx)(h.Z,{label:"Content",value:W,onChange:function(n){return J(n.target.value)},fullWidth:!0,multiline:!0,rows:4,sx:{mb:2}}),(0,r.jsx)("input",{type:"file",accept:"image/*",onChange:function(n){return H(n.target.files[0])},style:{marginBottom:16}}),F&&(0,r.jsx)("img",{src:F,alt:"news",style:{maxWidth:200,marginBottom:8}}),(0,r.jsxs)(l.Z,{sx:{mt:1},children:[(0,r.jsx)(m.Z,{onClick:M,color:"primary",children:(0,r.jsx)(b.Z,{})}),(0,r.jsx)(m.Z,{onClick:Q,color:"secondary",children:(0,r.jsx)(j.Z,{})})]})]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(f.Z,{variant:"h6",children:n.title}),(0,r.jsx)(f.Z,{variant:"caption",color:"text.secondary",children:n.created?new Date(n.created).toLocaleString():""}),(0,r.jsx)(f.Z,{sx:{mt:1},children:n.content}),n.imageUrl&&(0,r.jsx)(l.Z,{sx:{mt:2},children:(0,r.jsx)("img",{src:n.imageUrl,alt:"news",style:{maxWidth:300,borderRadius:8}})}),(0,r.jsxs)(l.Z,{sx:{mt:1},children:[(0,r.jsx)(m.Z,{onClick:function(){return function(n){N(n.id),E(n.title),J(n.content),X(n.imageUrl||""),H(null)}(n)},color:"primary",children:(0,r.jsx)(g.Z,{})}),(0,r.jsx)(m.Z,{onClick:function(){return K(n.id,n.imageUrl)},color:"error",children:(0,r.jsx)(w.Z,{})})]})]})})},n.id||t)}))]})}var C=(0,a.Z)((function(n){var t=n.loading,e=n.user,a=n.onBtnLogoutClick;return(0,r.jsx)(i.Z,{loading:t,user:e,onBtnLogoutClick:a,accLevel:u.DW.ADMIN,children:(0,r.jsx)(Z,{})})}))},98993:function(n,t,e){"use strict";e.d(t,{yQ:function(){return p},lh:function(){return m},jB:function(){return w},kN:function(){return b}});var r=e(34051),a=e.n(r),i=e(89328),u=e(36100),c=e(86650);function o(n,t,e,r,a,i,u){try{var c=n[i](u),o=c.value}catch(s){return void e(s)}c.done?t(o):Promise.resolve(o).then(r,a)}function s(n){return function(){var t=this,e=arguments;return new Promise((function(r,a){var i=n.apply(t,e);function u(n){o(i,r,a,u,c,"next",n)}function c(n){o(i,r,a,u,c,"throw",n)}u(void 0)}))}}function l(n,t,e){return t in n?Object.defineProperty(n,t,{value:e,enumerable:!0,configurable:!0,writable:!0}):n[t]=e,n}function f(n){for(var t=1;t<arguments.length;t++){var e=null!=arguments[t]?arguments[t]:{},r=Object.keys(e);"function"===typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(e).filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})))),r.forEach((function(t){l(n,t,e[t])}))}return n}var h="news",x=(0,c.cF)();function p(n,t){return d.apply(this,arguments)}function d(){return(d=s(a().mark((function n(t,e){var r,o,s;return a().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(r="",!e){n.next=8;break}return o=(0,c.iH)(x,"news/".concat(Date.now(),"_").concat(e.name)),n.next=5,(0,c.KV)(o,e);case 5:return n.next=7,(0,c.Jt)(o);case 7:r=n.sent;case 8:return n.next=10,(0,u.ET)((0,u.hJ)(i.db,h),f({},t,{imageUrl:r,created:(new Date).toISOString()}));case 10:return s=n.sent,n.abrupt("return",s.id);case 12:case"end":return n.stop()}}),n)})))).apply(this,arguments)}function m(){return v.apply(this,arguments)}function v(){return(v=s(a().mark((function n(){var t,e;return a().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return t=(0,u.IO)((0,u.hJ)(i.db,h),(0,u.Xo)("created","desc")),n.next=3,(0,u.PL)(t);case 3:return e=n.sent,n.abrupt("return",e.docs.map((function(n){return f({id:n.id},n.data())})));case 5:case"end":return n.stop()}}),n)})))).apply(this,arguments)}function w(n,t,e,r){return g.apply(this,arguments)}function g(){return(g=s(a().mark((function n(t,e,r,o){var s,l,p;return a().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(s=o||"",!r){n.next=17;break}if(!o){n.next=11;break}return n.prev=3,l=(0,c.iH)(x,o),n.next=7,(0,c.oq)(l);case 7:n.next=11;break;case 9:n.prev=9,n.t0=n.catch(3);case 11:return p=(0,c.iH)(x,"news/".concat(Date.now(),"_").concat(r.name)),n.next=14,(0,c.KV)(p,r);case 14:return n.next=16,(0,c.Jt)(p);case 16:s=n.sent;case 17:return n.next=19,(0,u.r7)((0,u.JU)(i.db,h,t),f({},e,{imageUrl:s,updated:(new Date).toISOString()}));case 19:case"end":return n.stop()}}),n,null,[[3,9]])})))).apply(this,arguments)}function b(n,t){return j.apply(this,arguments)}function j(){return(j=s(a().mark((function n(t,e){var r;return a().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(!e){n.next=9;break}return n.prev=1,r=(0,c.iH)(x,e),n.next=5,(0,c.oq)(r);case 5:n.next=9;break;case 7:n.prev=7,n.t0=n.catch(1);case 9:return n.next=11,(0,u.oe)((0,u.JU)(i.db,h,t));case 11:case"end":return n.stop()}}),n,null,[[1,7]])})))).apply(this,arguments)}}},function(n){n.O(0,[5124,7739,972,1903,3028,6038,9323,1050,9774,2888,179],(function(){return t=45577,n(n.s=t);var t}));var t=n.O();_N_E=t}]);