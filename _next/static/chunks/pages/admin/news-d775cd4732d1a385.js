(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8533],{45577:function(n,e,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/admin/news",function(){return t(73854)}])},73854:function(n,e,t){"use strict";t.r(e),t.d(e,{default:function(){return S}});var r=t(85893),a=t(95243),i=t(66383),u=t(47426),c=t(34051),o=t.n(c),s=t(67294),l=t(87357),f=t(15861),p=t(61903),h=t(11057),x=t(66242),d=t(44267),m=t(93946),v=t(98993),w=t(41733),g=t(77957),b=t(66818),j=t(44510);function y(n,e,t,r,a,i,u){try{var c=n[i](u),o=c.value}catch(s){return void t(s)}c.done?e(o):Promise.resolve(o).then(r,a)}function k(n){return function(){var e=this,t=arguments;return new Promise((function(r,a){var i=n.apply(e,t);function u(n){y(i,r,a,u,c,"next",n)}function c(n){y(i,r,a,u,c,"throw",n)}u(void 0)}))}}function Z(){var n=(0,s.useState)([]),e=n[0],t=n[1],a=(0,s.useState)(""),i=a[0],u=a[1],c=(0,s.useState)(""),y=c[0],Z=c[1],S=(0,s.useState)(null),C=S[0],_=S[1],O=(0,s.useState)(null),P=O[0],N=O[1],D=(0,s.useState)(""),B=D[0],E=D[1],U=(0,s.useState)(""),W=U[0],I=U[1],J=(0,s.useState)(null),L=J[0],R=J[1],T=(0,s.useState)(""),H=T[0],F=T[1];(0,s.useEffect)((function(){(0,v.lh)().then(t)}),[]);var X=function(){var n=k(o().mark((function n(){return o().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(i&&y){n.next=2;break}return n.abrupt("return");case 2:return n.next=4,(0,v.yQ)({title:i,content:y},C);case 4:u(""),Z(""),_(null),(0,v.lh)().then(t);case 8:case"end":return n.stop()}}),n)})));return function(){return n.apply(this,arguments)}}(),q=function(){var n=k(o().mark((function n(e,r){return o().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(!window.confirm("Delete this news?")){n.next=4;break}return n.next=3,(0,v.kN)(e,r);case 3:(0,v.lh)().then(t);case 4:case"end":return n.stop()}}),n)})));return function(e,t){return n.apply(this,arguments)}}(),K=function(){var n=k(o().mark((function n(){return o().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,(0,v.jB)(P,{title:B,content:W},L,H);case 2:N(null),E(""),I(""),R(null),F(""),(0,v.lh)().then(t);case 8:case"end":return n.stop()}}),n)})));return function(){return n.apply(this,arguments)}}(),M=function(){N(null),E(""),I(""),R(null),F("")};return(0,r.jsxs)(l.Z,{sx:{maxWidth:800,mx:"auto",mt:4},children:[(0,r.jsx)(f.Z,{variant:"h4",gutterBottom:!0,children:"News Management"}),(0,r.jsxs)(l.Z,{sx:{mb:3},children:[(0,r.jsx)(p.Z,{label:"Title",value:i,onChange:function(n){return u(n.target.value)},fullWidth:!0,sx:{mb:2}}),(0,r.jsx)(p.Z,{label:"Content",value:y,onChange:function(n){return Z(n.target.value)},fullWidth:!0,multiline:!0,minRows:4,maxRows:16,sx:{mb:2},InputProps:{style:{whiteSpace:"pre-line",overflow:"auto"}}}),(0,r.jsx)("input",{type:"file",accept:"image/*",onChange:function(n){return _(n.target.files[0])},style:{marginBottom:16}}),(0,r.jsx)(h.Z,{variant:"contained",onClick:X,children:"Create News"})]}),e.map((function(n,e){return(0,r.jsx)(x.Z,{sx:{mb:2,position:"relative"},children:(0,r.jsx)(d.Z,{children:P===n.id?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(p.Z,{label:"Title",value:B,onChange:function(n){return E(n.target.value)},fullWidth:!0,sx:{mb:2}}),(0,r.jsx)(p.Z,{label:"Content",value:W,onChange:function(n){return I(n.target.value)},fullWidth:!0,multiline:!0,minRows:4,maxRows:16,sx:{mb:2},InputProps:{style:{whiteSpace:"pre-line",overflow:"auto"}}}),(0,r.jsx)("input",{type:"file",accept:"image/*",onChange:function(n){return R(n.target.files[0])},style:{marginBottom:16}}),H&&(0,r.jsx)("img",{src:H,alt:"news",style:{maxWidth:"100%",marginBottom:8}}),(0,r.jsxs)(l.Z,{sx:{mt:1},children:[(0,r.jsx)(m.Z,{onClick:K,color:"primary",children:(0,r.jsx)(b.Z,{})}),(0,r.jsx)(m.Z,{onClick:M,color:"secondary",children:(0,r.jsx)(j.Z,{})})]})]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(f.Z,{variant:"h6",children:n.title}),(0,r.jsx)(f.Z,{variant:"caption",color:"text.secondary",children:n.created?new Date(n.created).toLocaleString():""}),(0,r.jsx)(f.Z,{sx:{mt:1,whiteSpace:"pre-line"},children:n.content}),n.imageUrl&&(0,r.jsx)(l.Z,{sx:{mt:2},children:(0,r.jsx)("img",{src:n.imageUrl,alt:"news",style:{maxWidth:"100%",borderRadius:8}})}),(0,r.jsxs)(l.Z,{sx:{mt:1},children:[(0,r.jsx)(m.Z,{onClick:function(){return function(n){N(n.id),E(n.title),I(n.content),F(n.imageUrl||""),R(null)}(n)},color:"primary",children:(0,r.jsx)(g.Z,{})}),(0,r.jsx)(m.Z,{onClick:function(){return q(n.id,n.imageUrl)},color:"error",children:(0,r.jsx)(w.Z,{})})]})]})})},n.id||e)}))]})}var S=(0,a.Z)((function(n){var e=n.loading,t=n.user,a=n.onBtnLogoutClick;return(0,r.jsx)(i.Z,{loading:e,user:t,onBtnLogoutClick:a,accLevel:u.DW.ADMIN,children:(0,r.jsx)(Z,{})})}))},98993:function(n,e,t){"use strict";t.d(e,{yQ:function(){return x},lh:function(){return m},jB:function(){return w},kN:function(){return b}});var r=t(34051),a=t.n(r),i=t(89328),u=t(36100),c=t(86650);function o(n,e,t,r,a,i,u){try{var c=n[i](u),o=c.value}catch(s){return void t(s)}c.done?e(o):Promise.resolve(o).then(r,a)}function s(n){return function(){var e=this,t=arguments;return new Promise((function(r,a){var i=n.apply(e,t);function u(n){o(i,r,a,u,c,"next",n)}function c(n){o(i,r,a,u,c,"throw",n)}u(void 0)}))}}function l(n,e,t){return e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function f(n){for(var e=1;e<arguments.length;e++){var t=null!=arguments[e]?arguments[e]:{},r=Object.keys(t);"function"===typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(t).filter((function(n){return Object.getOwnPropertyDescriptor(t,n).enumerable})))),r.forEach((function(e){l(n,e,t[e])}))}return n}var p="news",h=(0,c.cF)();function x(n,e){return d.apply(this,arguments)}function d(){return(d=s(a().mark((function n(e,t){var r,o,s;return a().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(r="",!t){n.next=8;break}return o=(0,c.iH)(h,"news/".concat(Date.now(),"_").concat(t.name)),n.next=5,(0,c.KV)(o,t);case 5:return n.next=7,(0,c.Jt)(o);case 7:r=n.sent;case 8:return n.next=10,(0,u.ET)((0,u.hJ)(i.db,p),f({},e,{imageUrl:r,created:(new Date).toISOString()}));case 10:return s=n.sent,n.abrupt("return",s.id);case 12:case"end":return n.stop()}}),n)})))).apply(this,arguments)}function m(){return v.apply(this,arguments)}function v(){return(v=s(a().mark((function n(){var e,t;return a().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return e=(0,u.IO)((0,u.hJ)(i.db,p),(0,u.Xo)("created","desc")),n.next=3,(0,u.PL)(e);case 3:return t=n.sent,n.abrupt("return",t.docs.map((function(n){return f({id:n.id},n.data())})));case 5:case"end":return n.stop()}}),n)})))).apply(this,arguments)}function w(n,e,t,r){return g.apply(this,arguments)}function g(){return(g=s(a().mark((function n(e,t,r,o){var s,l,x;return a().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(s=o||"",!r){n.next=17;break}if(!o){n.next=11;break}return n.prev=3,l=(0,c.iH)(h,o),n.next=7,(0,c.oq)(l);case 7:n.next=11;break;case 9:n.prev=9,n.t0=n.catch(3);case 11:return x=(0,c.iH)(h,"news/".concat(Date.now(),"_").concat(r.name)),n.next=14,(0,c.KV)(x,r);case 14:return n.next=16,(0,c.Jt)(x);case 16:s=n.sent;case 17:return n.next=19,(0,u.r7)((0,u.JU)(i.db,p,e),f({},t,{imageUrl:s,updated:(new Date).toISOString()}));case 19:case"end":return n.stop()}}),n,null,[[3,9]])})))).apply(this,arguments)}function b(n,e){return j.apply(this,arguments)}function j(){return(j=s(a().mark((function n(e,t){var r;return a().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(!t){n.next=9;break}return n.prev=1,r=(0,c.iH)(h,t),n.next=5,(0,c.oq)(r);case 5:n.next=9;break;case 7:n.prev=7,n.t0=n.catch(1);case 9:return n.next=11,(0,u.oe)((0,u.JU)(i.db,p,e));case 11:case"end":return n.stop()}}),n,null,[[1,7]])})))).apply(this,arguments)}}},function(n){n.O(0,[5124,7739,8858,1903,6279,6038,9323,1050,9774,2888,179],(function(){return e=45577,n(n.s=e);var e}));var e=n.O();_N_E=e}]);