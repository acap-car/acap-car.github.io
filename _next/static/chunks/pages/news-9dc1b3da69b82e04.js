(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6134],{65141:function(e,n,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/news",function(){return t(19372)}])},19372:function(e,n,t){"use strict";t.r(n),t.d(n,{default:function(){return O}});var r=t(34051),i=t.n(r),a=t(85893),c=t(67294),s=t(2734),o=t(98396),u=t(87357),l=t(15861),p=t(11057),f=t(50657),d=t(37645),x=t(93946),v=t(6514),h=t(31425),m=t(50594),w=t(98993),b=t(89328),y=t(36100);function g(e,n,t,r,i,a,c){try{var s=e[a](c),o=s.value}catch(u){return void t(u)}s.done?n(o):Promise.resolve(o).then(r,i)}function k(e){return function(){var n=this,t=arguments;return new Promise((function(r,i){var a=e.apply(n,t);function c(e){g(a,r,i,c,s,"next",e)}function s(e){g(a,r,i,c,s,"throw",e)}c(void 0)}))}}function j(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function Z(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{},r=Object.keys(t);"function"===typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(t).filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})))),r.forEach((function(n){j(e,n,t[n])}))}return e}function O(){var e=(0,c.useState)([]),n=e[0],t=e[1],r=(0,c.useState)(!1),g=r[0],O=r[1],S=(0,c.useState)(null),P=S[0],_=S[1],D=(0,c.useState)(null),N=D[0],C=D[1],E=(0,c.useState)({}),J=E[0],W=E[1],B=(0,s.Z)(),I=(0,o.Z)(B.breakpoints.down("sm"));(0,c.useEffect)((function(){var e=!0;function n(){return(n=k(i().mark((function n(){var r;return i().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,(0,w.lh)();case 2:if(r=n.sent,e){n.next=5;break}return n.abrupt("return");case 5:return t(r||[]),n.next=8,Q(r||[]);case 8:case"end":return n.stop()}}),n)})))).apply(this,arguments)}return function(){n.apply(this,arguments)}(),function(){e=!1}}),[]);var U,L=function(e,n){return(null===e||void 0===e?void 0:e.id)||(null===e||void 0===e?void 0:e.newsId)||String(n)},T=/(https?:\/\/[^\s]+)/g,V=function(e){if(!e)return null;for(var n,t=[],r=0;null!==(n=T.exec(e));){var i=n.index,c=n[0];i>r&&t.push({type:"text",text:e.slice(r,i)}),t.push({type:"url",text:c}),r=i+c.length}return r<e.length&&t.push({type:"text",text:e.slice(r)}),t.map((function(e,n){return"url"===e.type?(0,a.jsx)("a",{href:e.text,target:"_blank",rel:"noopener noreferrer",style:{color:"#1976d2",textDecoration:"underline"},children:e.text},n):(0,a.jsx)("span",{children:e.text},n)}))},H=function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:600;if(!e)return"";var t=e.replace(/\s+/g," ").trim();return t.length>n?t.slice(0,n).trim()+"...":t},A=function(e){if(!e)return[];var n,t,r,i=null!==(r=null!==(t=null!==(n=e.imageUrl)&&void 0!==n?n:e.images)&&void 0!==t?t:e.imagesList)&&void 0!==r?r:"";if(!i)return[];if(Array.isArray(i))return i.filter(Boolean);if("string"===typeof i){try{var a=JSON.parse(i);if(Array.isArray(a))return a.filter(Boolean)}catch(c){}return i.split(",").map((function(e){return e.trim()})).filter(Boolean)}return[]},Q=function(){var e=k(i().mark((function e(){var n,t,r=arguments;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=r.length>0&&void 0!==r[0]?r[0]:[],t={},e.next=4,Promise.all((n||[]).map(function(){var e=k(i().mark((function e(n,r){var a,c,s,o;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=L(n,r),e.prev=1,c=(0,y.JU)(b.db,"news",a),e.next=5,(0,y.QT)(c);case 5:if(!(s=e.sent).exists()){e.next=17;break}if("number"===typeof(o=s.data()).views){e.next=14;break}return e.next=11,(0,y.pl)(c,{views:0},{merge:!0});case 11:t[a]=0,e.next=15;break;case 14:t[a]=o.views;case 15:e.next=20;break;case 17:return e.next=19,(0,y.pl)(c,{views:0},{merge:!0});case 19:t[a]=0;case 20:e.next=25;break;case 22:e.prev=22,e.t0=e.catch(1),t[a]=0;case 25:case"end":return e.stop()}}),e,null,[[1,22]])})));return function(n,t){return e.apply(this,arguments)}}()));case 4:W(t);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),F=function(){var e=k(i().mark((function e(n,t){var r,a,c,s,o,u,l;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=L(n,t),a=(0,y.JU)(b.db,"news",r),e.prev=2,e.next=5,(0,y.i3)(b.db,function(){var e=k(i().mark((function e(n){var t;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.get(a);case 2:(t=e.sent).exists()?"number"!==typeof t.data().views?n.update(a,{views:1}):n.update(a,{views:(0,y.nP)(1)}):n.set(a,{views:1},{merge:!0});case 4:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}());case 5:return e.prev=5,e.next=8,(0,y.QT)(a);case 8:return c=e.sent,s=c.exists()&&"number"===typeof c.data().views?c.data().views:0,W((function(e){return Z({},e,j({},r,s))})),e.abrupt("return",s);case 14:return e.prev=14,e.t0=e.catch(5),W((function(e){return Z({},e,j({},r,(e[r]||0)+1))})),e.abrupt("return",(J[r]||0)+1);case 18:e.next=39;break;case 20:return e.prev=20,e.t1=e.catch(2),console.error("incrementNewsView failed",e.t1),e.prev=23,e.next=26,(0,y.QT)(a);case 26:return o=e.sent,u=o.exists()&&"number"===typeof o.data().views?o.data().views+1:1,e.next=30,(0,y.pl)(a,{views:u},{merge:!0});case 30:return W((function(e){return Z({},e,j({},r,u))})),e.abrupt("return",u);case 34:return e.prev=34,e.t2=e.catch(23),console.error("incrementNewsView fallback failed",e.t2),e.abrupt("return",null!==(l=J[r])&&void 0!==l?l:0);case 39:case"end":return e.stop()}}),e,null,[[2,20],[5,14],[23,34]])})));return function(n,t){return e.apply(this,arguments)}}(),R=function(){var e=k(i().mark((function e(n,t){return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return _(n),C(t),O(!0),e.prev=3,e.next=6,F(n,t);case 6:e.next=11;break;case 8:e.prev=8,e.t0=e.catch(3),console.error("handleOpen increment failed",e.t0);case 11:case"end":return e.stop()}}),e,null,[[3,8]])})));return function(n,t){return e.apply(this,arguments)}}(),X=function(){O(!1),_(null),C(null)};return(0,a.jsxs)(u.Z,{sx:{maxWidth:1100,mx:"auto",mt:4,px:{xs:2,sm:3}},children:[(0,a.jsx)(l.Z,{variant:"h4",gutterBottom:!0,children:"News"}),0===n.length&&(0,a.jsx)(l.Z,{children:"No news yet."}),n.map((function(e,n){var t,r=A(e),i=r.length>0?r[0]:null,c=L(e,n);return(0,a.jsxs)(u.Z,{sx:{display:"flex",flexDirection:{xs:"column",sm:"row"},gap:2,alignItems:"flex-start",mb:3,p:2,borderRadius:2,bgcolor:"background.paper",boxShadow:1,cursor:"pointer"},onClick:function(){return R(e,n)},children:[i&&(0,a.jsx)(u.Z,{component:"img",src:i,alt:"thumb",sx:{width:{xs:"100%",sm:420},height:{xs:200,sm:260},objectFit:"cover",borderRadius:1,border:"1px solid #eee",flexShrink:0}}),(0,a.jsxs)(u.Z,{sx:{flex:1,minWidth:0},children:[(0,a.jsx)(l.Z,{variant:"h6",sx:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:{xs:"normal",sm:"nowrap"}},children:e.title}),(0,a.jsxs)(u.Z,{sx:{display:"flex",gap:2,alignItems:"center",mb:1,flexWrap:"wrap"},children:[(0,a.jsx)(l.Z,{variant:"caption",color:"text.secondary",children:e.created?new Date(e.created).toLocaleString():""}),(0,a.jsxs)(l.Z,{variant:"caption",color:"text.secondary",sx:{ml:"auto"},children:["Views: ",null!==(t=J[c])&&void 0!==t?t:0]})]}),(0,a.jsx)(l.Z,{variant:"body2",color:"text.secondary",sx:{display:"-webkit-box",WebkitLineClamp:{xs:5,sm:6},WebkitBoxOrient:"vertical",overflow:"hidden",textOverflow:"ellipsis",mb:1},children:V(H(e.content))}),(0,a.jsx)(p.Z,{size:"small",onClick:function(t){t.stopPropagation(),R(e,n)},children:"See more"})]})]},c)})),(0,a.jsxs)(f.Z,{open:g,onClose:X,fullWidth:!0,maxWidth:"md",fullScreen:I,children:[(0,a.jsxs)(d.Z,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between",py:{xs:1,sm:2}},children:[(0,a.jsxs)(u.Z,{sx:{display:"flex",flexDirection:"column",gap:.5},children:[(0,a.jsx)("span",{style:{wordBreak:"break-word",fontWeight:600},children:null===P||void 0===P?void 0:P.title}),(0,a.jsx)(l.Z,{variant:"caption",color:"text.secondary",children:(null===P||void 0===P?void 0:P.created)?new Date(P.created).toLocaleString():""}),(0,a.jsxs)(l.Z,{variant:"caption",color:"text.secondary",children:["Views: ",P&&null!==(U=J[L(P,N)])&&void 0!==U?U:0]})]}),(0,a.jsx)(x.Z,{onClick:X,size:"small",children:(0,a.jsx)(m.Z,{})})]}),(0,a.jsxs)(v.Z,{dividers:!0,sx:{p:{xs:2,sm:3}},children:[P&&A(P).length>0&&(0,a.jsx)(u.Z,{sx:{display:"flex",flexDirection:"column",gap:2,mb:2},children:A(P).map((function(e,n){return(0,a.jsx)(u.Z,{component:"img",src:e,alt:"news-".concat(n),sx:{width:"100%",maxHeight:{xs:360,sm:520},objectFit:"cover",borderRadius:1}},n)}))}),(0,a.jsx)(l.Z,{variant:"caption",color:"text.secondary",sx:{display:"block",mb:1},children:(null===P||void 0===P?void 0:P.created)?new Date(P.created).toLocaleString():""}),(0,a.jsx)(l.Z,{component:"div",sx:{whiteSpace:"pre-line"},children:V(null===P||void 0===P?void 0:P.content)})]}),(0,a.jsx)(h.Z,{sx:{p:{xs:1,sm:2}},children:(0,a.jsx)(p.Z,{onClick:X,children:"Close"})})]})]})}},98993:function(e,n,t){"use strict";t.d(n,{yQ:function(){return x},lh:function(){return h},jB:function(){return w},kN:function(){return y}});var r=t(34051),i=t.n(r),a=t(89328),c=t(36100),s=t(86650);function o(e,n,t,r,i,a,c){try{var s=e[a](c),o=s.value}catch(u){return void t(u)}s.done?n(o):Promise.resolve(o).then(r,i)}function u(e){return function(){var n=this,t=arguments;return new Promise((function(r,i){var a=e.apply(n,t);function c(e){o(a,r,i,c,s,"next",e)}function s(e){o(a,r,i,c,s,"throw",e)}c(void 0)}))}}function l(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function p(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{},r=Object.keys(t);"function"===typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(t).filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})))),r.forEach((function(n){l(e,n,t[n])}))}return e}var f="news",d=(0,s.cF)();function x(e,n){return v.apply(this,arguments)}function v(){return(v=u(i().mark((function e(n,t){var r,o,u;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r="",!t){e.next=8;break}return o=(0,s.iH)(d,"news/".concat(Date.now(),"_").concat(t.name)),e.next=5,(0,s.KV)(o,t);case 5:return e.next=7,(0,s.Jt)(o);case 7:r=e.sent;case 8:return e.next=10,(0,c.ET)((0,c.hJ)(a.db,f),p({},n,{imageUrl:r,created:(new Date).toISOString()}));case 10:return u=e.sent,e.abrupt("return",u.id);case 12:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function h(){return m.apply(this,arguments)}function m(){return(m=u(i().mark((function e(){var n,t;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=(0,c.IO)((0,c.hJ)(a.db,f),(0,c.Xo)("created","desc")),e.next=3,(0,c.PL)(n);case 3:return t=e.sent,e.abrupt("return",t.docs.map((function(e){return p({id:e.id},e.data())})));case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function w(e,n,t,r){return b.apply(this,arguments)}function b(){return(b=u(i().mark((function e(n,t,r,o){var u,l,x;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(u=o||"",!r){e.next=17;break}if(!o){e.next=11;break}return e.prev=3,l=(0,s.iH)(d,o),e.next=7,(0,s.oq)(l);case 7:e.next=11;break;case 9:e.prev=9,e.t0=e.catch(3);case 11:return x=(0,s.iH)(d,"news/".concat(Date.now(),"_").concat(r.name)),e.next=14,(0,s.KV)(x,r);case 14:return e.next=16,(0,s.Jt)(x);case 16:u=e.sent;case 17:return e.next=19,(0,c.r7)((0,c.JU)(a.db,f,n),p({},t,{imageUrl:u,updated:(new Date).toISOString()}));case 19:case"end":return e.stop()}}),e,null,[[3,9]])})))).apply(this,arguments)}function y(e,n){return g.apply(this,arguments)}function g(){return(g=u(i().mark((function e(n,t){var r;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t){e.next=9;break}return e.prev=1,r=(0,s.iH)(d,t),e.next=5,(0,s.oq)(r);case 5:e.next=9;break;case 7:e.prev=7,e.t0=e.catch(1);case 9:return e.next=11,(0,c.oe)((0,c.JU)(a.db,f,n));case 11:case"end":return e.stop()}}),e,null,[[1,7]])})))).apply(this,arguments)}}},function(e){e.O(0,[5124,7739,3203,9364,9774,2888,179],(function(){return n=65141,e(e.s=n);var n}));var n=e.O();_N_E=n}]);